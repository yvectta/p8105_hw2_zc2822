---
title: "p8105_hw2_zc2822"
author: "Zhengyong Chen"
output: github_document
---

```{r setup, echo=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
library(haven)
```

## Problem 2

Read and clean the Mr. Trash Wheel sheet:

```{r}
mr_trash_df = read_excel("data/202409\ Trash\ Wheel\ Collection\ Data.xlsx", 
                      sheet = "Mr. Trash Wheel",
                      na = c("NA", ".", ""),
                      range = "A2:N655"
                      ) |> 
  janitor::clean_names() |> 
  filter(!is.na(dumpster)) |> 
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls),
    trash_wheel = "Mr. Trash Wheel",
    year = as.numeric(year)
  ) |> 
  relocate(trash_wheel)
```

Read and clean the Professor Trash Wheel sheet:

```{r}
prof_trash_df = read_excel("data/202409\ Trash\ Wheel\ Collection\ Data.xlsx", 
                      sheet = "Professor Trash Wheel",
                      na = c("NA", ".", ""),
                      range = "A2:M123"
                      ) |> 
  janitor::clean_names() |> 
  filter(!is.na(dumpster)) |> 
  mutate(
    trash_wheel = "Professor Trash Wheel",
    year = as.numeric(year)
  ) |> 
  relocate(trash_wheel)
```

Read and clean the Gwynnda Trash Wheel sheet:

```{r}
gwynnda_trash_df = read_excel("data/202409\ Trash\ Wheel\ Collection\ Data.xlsx", 
                      sheet = "Gwynnda Trash Wheel",
                      na = c("NA", ".", ""),
                      range = "A2:L266"
                      ) |> 
  janitor::clean_names() |> 
  filter(!is.na(dumpster)) |> 
  mutate(
    trash_wheel = "Gwynnda Trash Wheel",
    year = as.numeric(year)
  ) |> 
  relocate(trash_wheel)
```

Combine the datasets:

```{r}
combined_trash_df = bind_rows(mr_trash_df, prof_trash_df, gwynnda_trash_df)
```

A paragraph about these data:

The number of observations in the resulting dataset is `r nrow(combined_trash_df)`. The variables in the datasets are `r colnames(combined_trash_df)`. The total weight of trash collected by Professor Trash Wheel was `r sum(prof_trash_df$weight_tons, na.rm = TRUE)`. The total number of cigarette butts collected by Gwynnda in June of 2022 was `r gwynnda_trash_df |> filter(year == 2022, month == "June") |> pull(cigarette_butts) |> sum(na.rm = TRUE) |> as.integer()`.




